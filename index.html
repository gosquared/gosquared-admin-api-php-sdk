<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>

    <title>GoSquared Admin API SDK</title>

    <style type="text/css">
      body {
        margin-top: 1.0em;
        font-family: Helvetica, Arial, FreeSans, san-serif;
      }
      #container {
        margin: 0 auto;
        width: 700px;
      }
      h1 { font-size: 3.8em;  margin-bottom: 3px; }
      h1 .small { font-size: 0.4em; }
      h1 a { text-decoration: none; }
      h2 { font-size: 1.5em; }
      h3 { text-align: center;  }
      a { color: #551A8B; text-decoration: none; }
      .description { font-size: 1.2em; margin-bottom: 30px; margin-top: 30px; font-style: italic;}
      #download { float: right; }
      pre { background: #000; color: #fff; padding: 15px; overflow: auto; }
      hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
      .footer { text-align:center; padding-top:30px; font-style: italic; }
      #sidebar{
        position: fixed;
        top: 0;
        left: 0;
        margin: 15px;
      }
      #sidebar ul{
        list-style-type: none;
        text-align: left;
        margin: 0;
        padding: 0 0 0 15px;
      }

    </style>
  </head>

  <body>
    <a href="http://github.com/TheDeveloper/gosquared-admin-api-php-sdk"><img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub" /></a>
    <div id ="wrapper">
      <div id="sidebar">
        <ul class="sidebar_list">
          <li><h4><a href="#download">Download</a></h4></li>
          <li><h4><a href="#guide">Guide</a></h4></li>
          <li>
            <ul>
              <li><a href="#configuration">Configuration</a></li>
              <li><a href="#testing">Testing</a></li>
              <li><a href="#making_requests">Making Requests</a></li>
              <li><a href="#handling_responses">Handing Responses</a></li>
            </ul>
          </li>
          <li><h4>Actions</h4></li>
          <li>
            <ul>
              <li><a href="#accounts">Accounts</a></li>
              <li><a href="#sites">Sites</a></li>
            </ul>
          </li>
        </ul>
      </div>
      <div id="container">
        <div id="download">
          <a href="http://github.com/TheDeveloper/gosquared-admin-api-php-sdk/zipball/master">
            <img border="0" width="90" src="http://github.com/images/modules/download/zip.png" /></a>
          <a href="http://github.com/TheDeveloper/gosquared-admin-api-php-sdk/tarball/master">
            <img border="0" width="90" src="http://github.com/images/modules/download/tar.png" /></a>
        </div>

        <h1><a href="http://github.com/TheDeveloper/gosquared-admin-api-php-sdk">GoSquared Admin API SDK</a><br />
        </h1>

        <div class="description">
          The official PHP SDK for the GoSquared admin API
        </div>

        <h2>Download</h2>
        <p>
          You can download this project in either
          <a href="http://github.com/TheDeveloper/gosquared-admin-api-php-sdk/zipball/master">zip</a> or
          <a href="http://github.com/TheDeveloper/gosquared-admin-api-php-sdk/tarball/master">tar</a> formats.
        </p>
        <p>
          You can also clone the project with <a href="http://git-scm.com">Git</a>
          by running:</p>
        <pre>$ git clone git://github.com/TheDeveloper/gosquared-admin-api-php-sdk</pre>

        <p>
          Add it as a submodule to your project by running:</p>
        <pre>$ git submodule add git://github.com/TheDeveloper/gosquared-admin-api-php-sdk</pre>


        <h2 id="guide">Guide</h2>
        <p>
          <b>Note: If you don't want to use the PHP SDK, you can still follow the URL and POST examples.</b>
        </p>
        <p>
          The SDK code examples are accompanied by the equivalent URL and POST they generate.
        </p>

        <h3 id="configuration">Configuration</h3>
        <p>
          You need to move config.sample.inc.php to config.inc.php, and drop in your API key. The sample config file looks like this:</p>
        <pre>
define("GS_ADMIN_SDK_API_KEY", "");                           // Your API Key here. Contact us at support@gosquared.com if you'd like access
define("GS_ADMIN_SDK_API_ENV", "sandbox");                    // Set to sandbox when testing
define("GS_ADMIN_SDK_API_VERSION", '1.0');                    // Set to the API version you require
/*
 * This next option allows you to control debugging functionality. This enables verbose logging, and all URLs send to the
 * GoSquared api will be logged to STDOUT. Please ensure this is set to false when in production.
 */
define("GS_ADMIN_SDK_DEBUG", false);

// You shouldn't change these
define('GS_ADMIN_SDK_API_URL_SCHEME', 'https');
define('GS_ADMIN_SDK_API_HOST', 'www.gosquared.com');
define('GS_ADMIN_SDK_API_ENDPOINT', '/api/admin_api.php');
        </pre>
        <p>
          We recommend running the tests only when the environment is set to "sandbox". When you're ready to go live, set this directive to "production"
        </p>

        <h3 id="testing">Testing</h3>
        <p>
          The test suite is backed by PHPUnit. <a href="https://github.com/sebastianbergmann/phpunit/">Here are instructions on installing PHPUnit</a>.<br />
          To run the tests:
        </p>
        <pre>phpunit test/testSuite.php</pre>
        <p>
          The tests will fail if you have not set the configuration properly. Read about <a href="#configuration">configuration</a>.<br />
          We recommend you run the test suite to ensure that all actions are operational.
        </p>
        
        <h3 id="making_requests">Making Requests</h3>
        <p>
          The SDK automatically generates & executes the request URL, signatures and POST payloads when you call its methods.<br />
          Each action is a method in the SDK. For example:
        </p>
        <pre>
// We want to create an account. To do this, we just call the create_account method
$gosquared_admin = new GS_ADMIN_SDK();
$res = $gosquared_admin->create_account($email, $password, $first_name, $last_name);
        </pre>
        <p>
          If you're can't use the PHP SDK, you will have to generate the request URLs yourself.<br />
          Request URLs are documented for each action. The parameters are fairly straightforward, but <i>api_key_hash</i> and <i>sign</i> require a little more tinkering:<br />
        </p>
        <table>
          <tr><td><b>api_key_hash</b></td><td>This is the 40 character sha1 hash of your API key</td></tr>
          <tr><td><b>sign</b></td><td>This is the keyed hash value of the POST body string. The hash algorithm is sha1 and the hash key is your api key.</td></tr>
        </table>
        
        <h3 id="handling_responses">Handling Responses</h3>
        <p>
          When you call an SDK method, the returned variable will be an object containing information about that action.<br />
          The object contains the following properties:
        </p>
        <table>
          <tr><td><b>succeeded</b></td><td>Boolean true or false to indicate whether the request succeeded</td></tr>
          <tr><td><b>data</b></td><td>An array of the data sent back with the result of the action.</td></tr>
          <tr><td><b>errors</b></td><td>An object containing information about any errors that were encountered with the action.</td></tr>
        </table>
        An example of handling a response:
        <pre>
$gosquared_admin = new GS_ADMIN_SDK();
$res = $gosquared_admin->create_account($email, $password, $first_name, $last_name);
$user_id = false;
if($res->succeeded) $user_id = $res->data['user_id'];
        </pre>

        <h2 id="accounts">Accounts</h2>
        <p>
          You create accounts for each user you want to sign up to GoSquared.
        </p>

        <h3 id="#func_create_account">create_account</h3>
        <p>
          Create a user account.</p>
        <pre>
$email = 'jemima@puddledu.ck';
$password = 'testpassword';
$first_name = 'Jemima';
$last_name = 'Puddleduck';
$gosquared_admin = new GS_ADMIN_SDK();
$res = $gosquared_admin->create_account($email, $password, $first_name, $last_name);
        </pre>
        URL:
        <pre>https://master.local/api/admin_api.php
  ?format=json
  &api_key_hash=xxxxxxxxxxxxxxxxxxxxxxx
  &env=sandbox
  &mode=create_account
  &sign=bafd3b1f187adc06ekf1024e6bae19756358ca34
  &version=1.0</pre>
        POST:
        <pre>
email=jemima@puddledu.ck
&password=testpassword
&first_name=Jemima
&last_name=Puddleduck
&timecode=2011-10-19T14%3A07%3A21Z</pre>
        Response data:
        <table>
          <tr><td><b>user_id</b></td><td>The unique numerical ID of the new GoSquared account</td></tr>
        </table>


        <h3 id="#func_modify_account">modify_account</h3>
        <p>
          Modify a user account. Leave any arguments you don't wish to modify as null.
        </p>
        <pre>
$user_id = 485964685;
$email = 'john@puddledu.ck';
$password = 'anothertestpassword';
$first_name = 'John';
$last_name = null;
$gosquared_admin = new GS_ADMIN_SDK();
$res = $gosquared_admin->modify_account($user_id, $email, $password, $first_name, $last_name);
        </pre>
        URL:
        <pre>https://master.local/api/admin_api.php
  ?format=json
  &api_key_hash=xxxxxxxxxxxxxxxxxxxxxxx
  &env=sandbox
  &mode=modify_account
  &sign=bafd3b1f187adc06ekf1024e6bae19756358ca34
  &version=1.0</pre>
        POST:
        <pre>
user_id=485964685
&email=john@puddledu.ck
&password=anothertestpassword
&first_name=John
&timecode=2011-10-19T14%3A07%3A21Z</pre>
        Response data:
        <table>
          <tr><td><b>user_id</b></td><td>The unique numerical ID of the GoSquared account that was modified</td></tr>
        </table>

        <h3 id="#func_purge_account">purge_account</h3>
        <p>
          Purge an account. <b>Warning: This deletes everything for the account!</b>
        </p>
        <pre>
$user_id = 485964685;
$gosquared_admin = new GS_ADMIN_SDK();
$res = $gosquared_admin->purge_account($user_id);
        </pre>
        URL:
        <pre>https://master.local/api/admin_api.php
  ?format=json
  &api_key_hash=xxxxxxxxxxxxxxxxxxxxxxx
  &env=sandbox
  &mode=purge_account
  &sign=bafd3b1f187adc06ekf1024e6bae19756358ca34
  &version=1.0</pre>
        POST:
        <pre>
user_id=485964685
&timecode=2011-10-19T11%3A48%3A56Z</pre>
        Response data:
        <table>
          <tr><td><b>user_id</b></td><td>The unique numerical ID of the GoSquared account that was purged</td></tr>
        </table>

        <h3 id="#func_set_account_plan">set_account_plan</h3>
        <p>
          Put an account onto one of the available GoSquared plans. <a href="https://www.gosquared.com/plans/" target="_blank">See available plans</a>.
        </p>
        <pre>
$user_id = 485964685
$plan_name = 'standard';
$gosquared_admin = new GS_ADMIN_SDK();
$res = $gosquared_admin->set_account_plan($user_id, $plan_name);
        </pre>
        URL:
        <pre>https://master.local/api/admin_api.php
  ?format=json
  &api_key_hash=xxxxxxxxxxxxxxxxxxxxxxx
  &env=sandbox
  &mode=set_account_plan
  &sign=bafd3b1f187adc06ekf1024e6bae19756358ca34
  &version=1.0</pre>
        POST:
        <pre>
user_id=485964685
&plan_name=standard
&timecode=2011-10-19T11%3A48%3A56Z</pre>
        Response data:
        <table>
          <tr><td><b>user_id</b></td><td>The unique numerical ID of the GoSquared account</td></tr>
          <tr><td><b>plan_settings</b></td><td>An array of the settings of the plan assigned to the account</td></tr>
        </table>

        <h2 id="sites">Sites</h2>
        <p>
          A user account has sites tracked by GoSquared. Typically, there will be one site per domain.
        </p>

        <h3 id="#func_create_site">create_site</h3>
        <p>
          Create a site on a user account.
        </p>
        <pre>
$user_id = 485964685;
$site_name = 'Test Site';
$site_url = 'http://www.puddledu.ck';
$gosquared_admin = new GS_ADMIN_SDK();
$res = $gosquared_admin->create_site($user_id, $site_name, $site_url);
        </pre>
        URL:
        <pre>https://master.local/api/admin_api.php
  ?format=json
  &api_key_hash=xxxxxxxxxxxxxxxxxxxxxxx
  &env=sandbox
  &mode=create_site
  &sign=bafd3b1f187adc06ekf1024e6bae19756358ca34
  &version=1.0</pre>
        POST:
        <pre>
user_id=485964685
&site_name=Test+Site
&site_url=http%3A%2F%2Fwww.gosquared.com%2F
&timecode=2011-10-19T11%3A48%3A30Z</pre>
        Response data:
        <table>
          <tr><td><b>site_token</b></td><td>The unique site token for the new site</td></tr>
          <tr><td><b>gstc</b></td><td>The javascript code that should be placed on the site to enable tracking</td></tr>
        </table>

        <!--<h3 id="#func_cancel_subscription">cancel_subscription</h2>
        <p>
          Cancel a subscription.
          <pre>
$gosquared_admin = new GS_ADMIN_SDK();
$res = $gosquared_admin->cancel_subscription($user_id);
          </pre>
          URL:
          <pre>https://master.local/api/admin_api.php
  ?format=json
  &api_key_hash=xxxxxxxxxxxxxxxxxxxxxxx
  &env=sandbox
  &mode=cancel_subscription
  &sign=bafd3b1f187adc06ekf1024e6bae19756358ca34
  &version=1.0</pre>
          POST:
          <pre>
user_id=485964685
&timecode=2011-10-19T11%3A48%3A56Z</pre>
        </p>-->

        <div class="footer">
          get the source code on GitHub : <a href="http://github.com/TheDeveloper/gosquared-admin-api-php-sdk">TheDeveloper/gosquared-admin-api-php-sdk</a>
        </div>

      </div>

    </div>
  </body>
</html>
